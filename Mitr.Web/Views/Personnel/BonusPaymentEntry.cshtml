@model BonusPaymentEntry

<div class="inner-main">
    <h1 class="heading-one ">Bonus Payment Entry</h1>

    @using (Ajax.BeginForm("_BonusPaymentEntry", "Personnel",
            new { src = clsApplicationSetting.EncryptQueryString(ViewBag.MenuID.ToString() + "*/Personnel/_BonusPaymentEntry*" + ViewBag.FYID) },
              new AjaxOptions { HttpMethod = "POST", OnSuccess = "BindTarget", OnBegin = "ShowLoadingDialog()" },
        new { @id = "_BonusPaymentEntryFrom" })
        )
    {
        <div class="row">
            <div style="display:none">
                <button type="submit" class="btn mtr-g-grn btn-l ripplelink" id="btnSearch" name="Command" value="Search"><i class="fas fa-search"></i>Search</button>
            </div>
            <div class="col-sm-3 form-group">
                <label>Employee Name</label>
                @Html.DropDownListFor(x => Model.Empid, new SelectList(ViewBag.EmployeeList, "ID", "Name", Model.Empid), "Select", new { @class = "form-control  applyselect ddapplyaction" })
            </div>
            <div class="col-sm-3 form-group">
                <label>.</label>
                <button type="button" class="btn mtr-g-grn btn-l ripplelink" id="btnExportAll" value="Search"><i class="fas fa-file-excel"></i>Export</button>
            </div>
        </div>

    }
    <div id="TagetDiv"></div>
</div>




@section scripts    {
    @System.Web.Optimization.Scripts.Render("~/bundle/dataTablesjs")
    @System.Web.Optimization.Scripts.Render("~/bundle/unobtrusivejs")
    @Html.IncludeVersionedJs(Url.Content("~/assets/tableToExcel.js"))

    <script>
        $(document).ready(function () {
           
            BindData();
        });

        $(".ddapplyaction").bind("change", function () {
            BindData();
        });

        function BindData() {
           
        $("#TargetDiv").empty();
            var Empid = $("#Empid").find('option:selected').val();
			$.ajax({
                url: "/Personnel/_BonusPaymentEntry",
				type: "Post",
                data: { src: EncryptQueryStringJSON(@ViewBag.MenuID+"*" + "/Personnel/_BonusPaymentEntry" + "*" + Empid) },
                success: function (data)
                {
                   
					$("#TagetDiv").empty();
                    $("#TagetDiv").html(data);
                    $("#Empid").select2();
                    //DatatableScriptsWithColumnSearch("tablePersonnelStatus");
				},
                error: function (er) {
                   
					alert(er);

				}
			});
        }
        $("#btnExportAll").click(function (e) {
            exportReportToExcelAll()
        });
        function exportReportToExcelAll() {
           
            let table = document.getElementsByTagName("table"); // you can use document.getElementById('tableId') as well by providing id to the table tag
            TableToExcel.convert(table[0], { // html code may contain multiple tables so here we are refering to 1st table tag
                name: `BonusPaymentEntry_Report.xlsx`, // fileName you could use any name
                sheet: {
                    name: 'Sheet 1' // sheetName
                }
            });
        }

        function BindTarget(args) {
           
            CloseLoadingDialog();
            $("#TargetDiv").empty();
            $("#TargetDiv").html(args);
            $('[data-toggle="tooltip"]').tooltip();
            $(".applyselect").select2();

            //$(".btnTeam").click(function (e) {
            //    ConfirmMsgBox('Are you sure want to approve KPA ?', '', function () {
            //        $("#btnApprove").click();
            //    });
            //});
            //SHowHideSubmit();
        }
    </script>

}