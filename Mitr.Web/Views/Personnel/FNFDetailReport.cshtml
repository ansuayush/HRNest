
@model PMS.PMSStatus
@{
    ViewBag.Title = "FNFDetailReport";
}
<div class="inner-main">
    <h1 class="heading-one ">F&F Report</h1>
    <div class="row">
        <div class="col-lg-3 col-md-3 align-self-end slt-srh form-group">
            <label class="lbl-abs">Select Year</label>
            @Html.DropDownListFor(x => Model.FYID, new SelectList(ViewBag.FinYearList, "ID", "Year", Model.FYID), "Select Year", new { @class = "form-control  applyselect ddapplyaction1" })
            @Html.ValidationMessageFor(model => Model.FYID, "", new { @class = "text-danger" })
        </div>
        <div style="display:none">
            <button type="submit" class="btn mtr-g-grn btn-l ripplelink" id="btnSearch" name="Command" value="Search"><i class="fas fa-search"></i>Search</button>
        </div>
        <div class="col-sm-3 form-group">
            <label>Employee Name</label>
            @Html.DropDownListFor(x => Model.Empid, new SelectList(ViewBag.EmployeeList, "ID", "Name", Model.Empid), "All", new { @class = "form-control  applyselect ddapplyaction1" })
        </div>
        <div class="col-sm-3 form-group">
            <label>.</label>
            <button type="button" class="btn mtr-g-grn btn-l ripplelink" id="btnExportAll" value="Search"><i class="fas fa-file-excel"></i>Export</button>
        </div>
    </div>


    <div id="TagetDiv"></div>
</div>




@section scripts    {
    @System.Web.Optimization.Scripts.Render("~/bundle/dataTablesjs")
    @System.Web.Optimization.Scripts.Render("~/bundle/unobtrusivejs")

    @Html.IncludeVersionedJs(Url.Content("~/assets/tableToExcel.js"))

    <script>
        $(document).ready(function () {

            BindData();
        });

        $('.ddapplyaction').bind("change", function () {

            $("#btnSearch").click();
        });
        $(".ddapplyaction1").bind("change", function () {

            BindData();
        });

        function BindTarget(args) {

            CloseLoadingDialog();
            $("#TargetDiv").empty();
            $("#TargetDiv").html(args);
            $('[data-toggle="tooltip"]').tooltip();
            $(".applyselect").select2();

            //$(".btnTeam").click(function (e) {
            //    ConfirmMsgBox('Are you sure want to approve KPA ?', '', function () {
            //        $("#btnApprove").click();
            //    });
            //});
            //SHowHideSubmit();
        }

        function BindData() {

        $("#TargetDiv").empty();
            var FYID = $("#FYID").find('option:selected').val();
            var Empid = $("#Empid").find('option:selected').val();
			$.ajax({
                url: "/Personnel/_FNFDetailReport",
				type: "Post",
                data: { src: EncryptQueryStringJSON(@ViewBag.MenuID+"*" + "/Personnel/_FNFDetailReport" + "*" + Empid + "*" + FYID) },
                success: function (data)
                {

					$("#TagetDiv").empty();
                    $("#TagetDiv").html(data);
                    $("#Empid").select2();
                    $("#FYID").select2();
                    //DatatableScriptsWithColumnSearch("tablePersonnelStatus");
				},
                error: function (er) {

					alert(er);

				}
			});
        }
        $("#btnExportAll").click(function (e) {
            exportReportToExcelAll()
        });
        function exportReportToExcelAll() {

            let table = document.getElementsByTagName("table"); // you can use document.getElementById('tableId') as well by providing id to the table tag
            TableToExcel.convert(table[0], { // html code may contain multiple tables so here we are refering to 1st table tag
                name: `F&FDetail_Report.xlsx`, // fileName you could use any name
                sheet: {
                    name: 'Sheet 1' // sheetName
                }
            });
        }
    </script>

}