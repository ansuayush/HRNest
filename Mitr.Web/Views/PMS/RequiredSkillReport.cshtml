@model PMS.TrainingSkills
@{
	Layout = "~/Views/Shared/_Layout.cshtml";
}

@section style{
	@System.Web.Optimization.Styles.Render("~/bundle/dataTablecss")
}

<div class="inner-main defult-height">
	<h1 class="heading-one mb-0 ">PMS Training List</h1>


		<div class="row">

			<div class="col-lg-2 col-md-3 align-self-end slt-srh form-group">
				<label class="lbl-abs">Select Year</label>
				@Html.DropDownListFor(x => Model.FYId, new SelectList(ViewBag.FinYearList, "ID", "Year", Model.FYId), "Select Year", new { @class = "form-control  applyselect ddapplyaction1" })
				@Html.ValidationMessageFor(model => Model.FYId, "", new { @class = "text-danger" })
			</div>
			
			<div class="col-sm-3 form-group">
				<label>Employee Name</label>
				@Html.DropDownListFor(x => Model.EMPId, new SelectList(ViewBag.EmployeeList, "Id", "Name", Model.EMPId), "Select", new { @class = "form-control  applyselect ddapplyaction1" })
			</div>
			<div class="col-sm-3 form-group align-self-center">
				
				<button type="submit" class="btn mtr-g-grn btn-l ripplelink m-0" id="btnSearch" name="Command" value="Search"><i class="fas fa-search"></i>Search</button>
				<button type="button" class="btn mtr-g-grn btn-l ripplelink m-0" id="btnExportAll" value="Search"><i class="fas fa-file-excel"></i>Export</button>
			</div>
		</div>


	<div id="TagetDiv"></div>
</div>
@section scripts    {
	@System.Web.Optimization.Scripts.Render("~/bundle/dataTablesjs")
	<script src="~/assets/design/Scripts/AddInit.js?v=@clsApplicationSetting.GetWebConfigValue("Version")"></script>
	@System.Web.Optimization.Scripts.Render("~/bundle/unobtrusivejs");9999999999999999
	<script src="~/assets/tableToExcel.js"></script>

	<script>
        $(document).ready(function () {

           // BindData();
        });

       
		$("#btnSearch").click(function (e) {
			BindData();
		})
        function BindTarget(args) {

            CloseLoadingDialog();
            $("#TargetDiv").empty();
            $("#TargetDiv").html(args);
            $('[data-toggle="tooltip"]').tooltip();
            $(".applyselect").select2();


        }

        function BindData() {

        $("#TargetDiv").empty();
			var FYID = parseInt($("#FYId").find('option:selected').val());
			var Empid = $("#EMPId").find('option:selected').val();
			if (FYID > 0) {
				$.ajax({
				url: "/PMS/_RequiredSkillReport",
				type: "Post",
				data: { src: EncryptQueryStringJSON(@ViewBag.MenuID+"*" + "/PMS/_RequiredSkillReport" + "*" + Empid + "*" + FYID) },
                success: function (data)
                {

					$("#TagetDiv").empty();
                    $("#TagetDiv").html(data);
                    $("#Empid").select2();
                    $("#FYID").select2();
                    //DatatableScriptsWithColumnSearch("tablePMSStatus");
				},
                error: function (er) {

					alert(er);

				}
			});
			}
			else {
				SuccessToaster('Please Select Year');
			}

        }
        $("#btnExportAll").click(function (e) {
            exportReportToExcelAll()
        });
		function exportReportToExcelAll() {
			debugger;
            let table = document.getElementsByTagName("table"); // you can use document.getElementById('tableId') as well by providing id to the table tag
            TableToExcel.convert(table[0], { // html code may contain multiple tables so here we are refering to 1st table tag
				name: `_RequiredSkill_Report.xlsx`, // fileName you could use any name
                sheet: {
                    name: 'Sheet 1' // sheetName
                }
            });
        }
	</script>

}