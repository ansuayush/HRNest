@model IList<PMS.KPA.List>
@{
	var Modify = clsApplicationSetting.GetSessionValue("Modify");
	int isdeleted = 0, Approved = 0;
	string ApprovedStatus = "", Remarks = "";
	if (Model != null)
	{
		Approved = Model.Select(x => x.Approved).FirstOrDefault();
		isdeleted = Model.Select(x => x.isdeleted).FirstOrDefault();
		ApprovedStatus = Model.Select(x => x.ApprovedStatus).FirstOrDefault();
		Remarks = Model.Select(x => x.Remarks).FirstOrDefault();


	}
}


<input type="hidden" id="hdnApproved" value="@Approved" />
<input type="hidden" id="hdnisdeleted" value="@isdeleted" />
<input type="hidden" id="hdnApprovedStatus" value="@ApprovedStatus" />
<input type="hidden" id="hdnRemarks" value="@Remarks" />

<div class="tab-main ">
	<ul id="tabs" class="nav nav-tabs " role="tablist">
		<li class="nav-item"> <a id="tab-A" href="#active-log" class="nav-link active ripplelink" data-toggle="tab" role="tab"><i class="far fa-clock"></i>Pending</a> </li>
		<li class="nav-item"> <a id="tab-B" href="#leaves" class="nav-link ripplelink" data-toggle="tab" role="tab"><i class="fas fa-check"></i>Approved</a> </li>
		<li class="nav-item"> <a id="tab-C" href="#reject" class="nav-link ripplelink" data-toggle="tab" role="tab"><i class="fas fa-share"></i>Resubmit</a> </li>

	</ul>
	<div id="content" class="tab-content p-0" role="tablist">
		<div id="active-log" class="card tab-pane fade show active" role="tabpanel" aria-labelledby="tab-A">
			<div class="card-header" role="tab" id="heading-A">
				<h5 class="mb-0">
					<a data-toggle="collapse" href="#collapse-A" aria-expanded="true" aria-controls="collapse-A">Pending  <i class="fas fa-envelope-open"></i></a>
				</h5>
			</div>

			<div id="collapse-A" class="collapse show" data-parent="#content" role="tabpanel" aria-labelledby="heading-A">



				@using (Ajax.BeginForm("ApproveKPA", "PMS",
									new { src = clsApplicationSetting.EncryptQueryString(ViewBag.MenuID.ToString() + "*/PMS/ApproveKPA*" + ViewBag.FYID) },
						new AjaxOptions { HttpMethod = "POST", OnSuccess = "OnSuccessApproveKPA", OnBegin = "ShowLoadingDialog()" },
					new { @id = "_ApproveKPAFrom" })
					)
				{

					@Html.AntiForgeryToken()
					@Html.EJS().Grid("FlatGrid").DataSource((List<PMS.KPA.List>)Model.Where(x => x.Approved == 0).ToList()).GridLines(Syncfusion.EJ2.Grids.GridLine.Both).AllowTextWrap(true).Columns(col =>
			   {
				   col.Field("PMS_KPAID").Visible(false).Add();


				   col.Field("RowNum").HeaderText("SNo.").Width("30").Add();
				   col.Field("Area").HeaderText("Key Performance Area").Width("260").Add();
				   col.Field("UOMName").HeaderText("UOM").Width("80").Add();
				   col.Field("UOMType").HeaderText("UOM Type").Width("80").Add();
				   col.Field("IncType").HeaderText("KPA Type").Width("80").Add();
				   col.Field("AutoRating").HeaderText("Auto Rating").Width("80").Add();
				   col.Field("IsProbation").HeaderText("Probation").Width("80").Add();



			   }).AllowPaging().PageSettings(page => page.PageCount(10)).Toolbar(new List<string>() { "Search" }).Render()


					if (Model.Where(x => x.Approved == 0).Count() > 0 && isdeleted == 0)
					{
						<div class="col-sm-12 text-center">

							<button type="submit" style="display:none;" id="btnApprove" name="Command" value="Approved"></button>
							<button type="button" class="btn mtr-g-grn btn-l ripplelink pull-right btnTeam"><i class="fas fa-check"></i> Approve</button>
							<button type="button" class="btn blk-gdn-btn btn-l ripplelink pull-right" name="Command" value="Add" data-toggle="modal" data-target="#cm"><i class="fas fa-share"></i> Resubmit</button>
						</div>
					}

					<div class="modal fade" id="cm">
						<div class="modal-dialog ">
							<div class="modal-content">
								<!-- Modal Header -->
								<div class="modal-header">
									<h4 class="modal-title"><i class="fas fa-share"></i> Reason for Resubmission <span id="spnHead"></span></h4>
									<button type="button" class="close" data-dismiss="modal">×</button>
								</div>
								<div class="modal-body ">
									<div class="row">
										<div class="col-sm-12 form-group">
											<label>Enter Resubmission Reason</label>
											<textarea name="txtComments" placeholder="Enter " class="form-control h-100"></textarea>
										</div>


										<div class="col-lg-12 text-center mt-3">

											<button type="button" data-dismiss="modal" class="btn cnl-btn ripplelink  pull-right"><i class="fas fa-times"></i> Cancel</button>
											<button type="submit" class="btn mtr-o-grn btn-l ripplelink pull-right" name="Command" value="Resubmit"><i class="fa fa-paper-plane" aria-hidden="true"></i> Submit</button>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				}

			</div>
		</div>

		<div id="leaves" class="card tab-pane fade" role="tabpanel" aria-labelledby="tab-B">

			<div class="card-header" role="tab" id="heading-B">
				<h5 class="mb-0"> <a class="collapsed" data-toggle="collapse" href="#collapse-B" aria-expanded="false" aria-controls="collapse-B">Approved <i class="fas fa-check"></i></a> </h5>
			</div>

			<div id="collapse-B" class="collapse" data-parent="#content" role="tabpanel" aria-labelledby="heading-B">
				@Html.EJS().Grid("FlatGrid1").DataSource((List<PMS.KPA.List>)Model.Where(x => x.Approved == 1).ToList()).GridLines(Syncfusion.EJ2.Grids.GridLine.Both).AllowTextWrap(true).Columns(col =>
		   {
			   col.Field("PMS_KPAID").Visible(false).Add();

			   col.Field("RowNum").HeaderText("SNo.").Width("30").Add();
			   col.Field("Area").HeaderText("Key Performance Area").Width("260").Add();
			   col.Field("UOMName").HeaderText("UOM").Width("80").Add();
			   col.Field("UOMType").HeaderText("UOM Type").Width("80").Add();
			   col.Field("IncType").HeaderText("KPA Type").Width("80").Add();
			   col.Field("AutoRating").HeaderText("Auto Rating").Width("80").Add();
			   col.Field("IsProbation").HeaderText("Probation").Width("80").Add();

		   }).AllowPaging().PageSettings(page => page.PageCount(10)).Toolbar(new List<string>() { "Search" }).Render()

			</div>
		</div>


		<div id="reject" class="card tab-pane fade" role="tabpanel" aria-labelledby="tab-C">

			<div class="card-header" role="tab" id="heading-C">
				<h5 class="mb-0"> <a class="collapsed" data-toggle="collapse" href="#collapse-C" aria-expanded="false" aria-controls="collapse-B">Resubmit <i class="fas fa-check"></i></a> </h5>
			</div>

			<div id="collapse-C" class="collapse" data-parent="#content" role="tabpanel" aria-labelledby="heading-C">
				@Html.EJS().Grid("FlatGrid2").DataSource((List<PMS.KPA.List>)Model.Where(x => x.Approved == 2).ToList()).GridLines(Syncfusion.EJ2.Grids.GridLine.Both).AllowTextWrap(true).Columns(col =>
		   {
			   col.Field("PMS_KPAID").Visible(false).Add();

			   col.Field("RowNum").HeaderText("SNo.").Width("30").Add();
			   col.Field("Area").HeaderText("Key Performance Area").Width("260").Add();
			   col.Field("UOMName").HeaderText("UOM").Width("80").Add();
			   col.Field("UOMType").HeaderText("UOM Type").Width("80").Add();
			   col.Field("IncType").HeaderText("KPA Type").Width("80").Add();
			   col.Field("AutoRating").HeaderText("Auto Rating").Width("80").Add();
			   col.Field("IsProbation").HeaderText("Probation").Width("80").Add();

		   }).AllowPaging().PageSettings(page => page.PageCount(10)).Toolbar(new List<string>() { "Search" }).Render()

			</div>
		</div>

	</div>
</div>


@(Html.EJS().ScriptManager())
