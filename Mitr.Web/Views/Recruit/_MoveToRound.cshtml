@model Mitr.Models.InterviewSelection.MoveToRound

@using (Ajax.BeginForm("_MoveToRound", "Recruit",
		new { src = ViewBag.src },
		new AjaxOptions { HttpMethod = "POST", OnSuccess = "ActionOnSuccess", OnBegin = "ShowLoadingDialog()", OnFailure = "CloseLoadingDialog()" },
	new { @id = "_InterviewFrom", enctype = "multipart/form-data" })
	)
{
	<div class="row text-clr">
		<div class="col-lg-6 col-md-6 col-sm-6  form-group">
			<label>Candidate Name</label>
			@Html.TextBoxFor(x => Model.Name, new { @class = "form-control", @readonly = "readonly" })
			@Html.ValidationMessageFor(up => Model.Name, "", new { @class = "text-danger" })
		</div>
		<div class="col-lg-3 col-md-3 col-sm-6  form-group">
			<label>Current Salary</label>
			@Html.TextBoxFor(x => Model.CurrentSalary, new { @class = "form-control", @readonly = "readonly" })
			@Html.ValidationMessageFor(up => Model.CurrentSalary, "", new { @class = "text-danger" })

		</div>
		<div class="col-lg-3 col-md-3 col-sm-6  form-group">
			<label>Expected salary</label>
			@Html.TextBoxFor(x => Model.ExpectedSalary, new { @class = "form-control", @readonly = "readonly" })
			@Html.ValidationMessageFor(up => Model.ExpectedSalary, "", new { @class = "text-danger" })
		</div>
		<div class="col-sm-4 form-group">
			<label>Overall Average Score</label>
			@Html.TextBoxFor(x => Model.Score, new { @class = "form-control" })
			@Html.ValidationMessageFor(up => Model.Score, "", new { @class = "text-danger" })
		</div>

		<div class="col-sm-3 form-group">
			<label>Round</label>
			@Html.DropDownListFor(x => Model.RoundID, new SelectList(Model.RoundList, "ID", "Name", Model.RoundID), "Select Round",
	new { @class = "form-control  applyselect" })
			@Html.ValidationMessageFor(model => Model.RoundID, "", new { @class = "text-danger" })
		</div>
		<div class="col-sm-3 form-group">
			<label>Choose Slot</label>
			@Html.DropDownListFor(x => Model.SlotID, new SelectList(Model.SlotList, "ID", "Name", Model.SlotID), "Select Slot",
	new { @class = "form-control  applyselect" })
			@Html.ValidationMessageFor(model => Model.SlotID, "", new { @class = "text-danger" })
		</div>
		<div class="col-lg-12  form-group">
			<label>Remarks/Special Condition</label>
			@Html.TextAreaFor(x => Model.Reason, new { @class = "form-control", @placeholder = "Enter" })
			@Html.ValidationMessageFor(up => Model.Reason, "", new { @class = "text-danger" })

		</div>
		<div class="col-sm-12">
			<h3 class="subheading">Attachment</h3>
		</div>

		<div class="col-sm-12">
			<div class="table-ds">
				<div class="table-responsive">
					<table class="table table-striped mt-0" id="tbleAttach">
						<thead>
							<tr>
								<th class="w-50">S No.</th>
								<th class="w-150">Choose File</th>
								<th class="w-150">File</th>
								<th>Description</th>
								<th class="w-50">Action</th>
							</tr>
						</thead>
						@if (Model.AttachmentsList.Count > 0)
						{
							int count = 0;
							<tbody>
								@for (int i = 0; i < Model.AttachmentsList.Count; i++)
								{
									count++;
									<tr>
										<td>
											@*@Html.HiddenFor(model => model.AttachmentsList[i].FileExt)
										@Html.HiddenFor(model => model.AttachmentsList[i].ID)*@
											<label id="span_@count" name="span_@count">@count </label>
										</td>

										<td>
											@Html.TextBoxFor(model => model.AttachmentsList[i].Upload, new { @class = "form-control", @type = "file" })
											@Html.ValidationMessageFor(model => model.AttachmentsList[i].Upload, "", new { @class = "text-danger" })
										</td>
										<td>
											<a class="anchorlink" target="_blank" href="@Model.AttachmentsList[i].AttachmentPath">@Model.AttachmentsList[i].FileName</a>
										</td>

										<td>
											@Html.TextAreaFor(model => model.AttachmentsList[i].Description, new { @class = "form-control" })
											@Html.ValidationMessageFor(model => model.AttachmentsList[i].Description, "", new { @class = "text-danger" })
										</td>
										<td class="text-center">
											@if (count > 1)
											{
												<a onclick="DeleteRow(this)" data-toggle='tooltip' data-original-title='Remove'> <i class='fas fa-window-close red-clr m-0'></i></a>
											}
										</td>
									</tr>
								}
							</tbody>
						}
					</table>
				</div>
				<div class="text-right mt-2"><button onclick="AddNewRow()" type="button" class="btn green-clr ripplelink"><i class="fas fa-plus"></i> Add Row</button></div>
			</div>
			<div class="col-sm-12 form-group">
				<table class="table table-striped mb-0">
					<thead>
						<tr>
							<th width="10">S.NO</th>
							<th width="100">Round</th>
							<th width="100">Slot</th>
							<th width="150">Overall Average Score  </th>
							<th width="150">Panel Member</th>
							<th >Remarks/Special Condition </th>


						</tr>
					</thead>
					<tbody>
						@for (int i = 0; i < Model.QulifiedRoundList.Count; i++)
						{
                        <tr>
                            <td>@Model.QulifiedRoundList[i].RowNum</td>
                            <td>@Model.QulifiedRoundList[i].RoundName</td>
                            <td>@Model.QulifiedRoundList[i].SlotDate</td>
                            <td>@Model.QulifiedRoundList[i].Score</td>
                            <td><p class="ellipsis">@Model.QulifiedRoundList[i].PanelMember</p><i class="fas fa-info-circle td-info" data-toggle="tooltip" data-placement="right" data-original-title="@Model.QulifiedRoundList[i].PanelMember"></i>
                            <td><p class="ellipsis">@Model.QulifiedRoundList[i].Remarks</p>  <i class="fas fa-info-circle td-info" data-toggle="tooltip" data-placement="right" data-original-title="@Model.QulifiedRoundList[i].Remarks"></i></td>
                            
                        </tr>
						}

						</tbody>

				</table>
			</div>
			@if ((Model.listMoveRound != null) && (Model.listMoveRound.Count > 0))
			{
				int count = 0;
				<table class="table table-striped mt-0" id="tbleHistory">
					<thead>
						<tr>
							<th class="w-50">S No.</th>
							<th class="w-150">Round</th>
							<th class="w-150">Score</th>
							<th>PanelMember</th>
							<th class="w-50">Attechment</th>

						</tr>
					</thead>


					<tbody>
						@for (int i = 0; i < Model.listMoveRound.Count; i++)
						{
							count++;
							<tr>
								<td>
									@count
									<input type="hidden" name="SETID" value="@Model.listMoveRound[i].REC_InterviewID" />
								</td>
								<td>@Model.listMoveRound[i].RoundName</td>
								<td>@Model.listMoveRound[i].Score</td>
								<td>@Model.listMoveRound[i].PanelName</td>
								<td>
									<a class="btn blk-gdn-btn BtnReport" data-toggle="modal" data-target="#ftr"><i class="far fa-clipboard"></i>  Report</a>


								</td>

							</tr>
						}
					</tbody>

				</table>
			}

		</div>


		<div class="col-md-12 inpdgn">
			@Html.LabelFor(x => Model.chkConsider)
			@Html.CheckBoxFor(x => Model.chkConsider, new { @class = "form-control" })
			@Html.ValidationMessageFor(up => Model.chkConsider, "", new { @class = "text-danger" })

		</div>

		<div class="col-lg-12 text-center mt-3">


			<button type="submit" name="Command" value="Save" class="btn mtr-o-grn btn-l ripplelink pull-right"><i class="fas fa-save"></i> Save</button>
			<button type="button" class="btn cnl-btn ripplelink  pull-right" data-dismiss="modal"><i class="fas fa-times"></i> Cancel</button>
		</div>

	</div>
	<div class="modal fade pop-dgn" id="ftr">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header blk-gdn-btn">
					<a id="btnclose">X</a>
				</div>
				<div class="modal-body">
					<table class="table table-striped mt-0" id="tbleHistory">
						<thead>
							<tr>
								<th class="w-50">S No.</th>
								<th class="w-50">Attechment</th>
								<th class="w-50">Discription</th>
							</tr>
						</thead>


						<tbody id="filebind">
						</tbody>

					</table>
				</div>
			</div>
		</div>
	</div>
}

<script>
	// extend jquery range validator to work for required checkboxes
	var defaultRangeValidator = $.validator.methods.range;
	$.validator.methods.range = function (value, element, param) {
		if (element.type === 'checkbox') {
			// if it's a checkbox return true if it is checked
			return element.checked;
		} else {
			// otherwise run the default validation function
			return defaultRangeValidator.call(this, value, element, param);
		}
	}

	$(".BtnReport").click(function (e) {
		_Displayreport(this);
	});
	$("#btnclose").click(function (e) {
		$("#ftr").modal("hide");
	});

	function _Displayreport(obj) {
		debugger;
		var REC_InterviewSetID = $(obj).closest("tr").find("input:hidden[name=SETID]").val();
		ShowLoadingDialog();
		$.ajax({
			url: "/CommonAjax/_Displayreport",
			type: "Get",
			async: true,
			data: { REC_InterviewSetID: REC_InterviewSetID },
			success: function (data) {
				var output = data.map(i => "<tr><td>" + i.CountRow + "</td><td><a class='anchorlink' target='_blank' href='" + i.AttachmentPath + "'>" + i.FileName + "</a></td><td>" + i.Description + "</td></tr>");

				$("#filebind").html(output)

				CloseLoadingDialog();

			},
			error: function (er) {
				alert(er);
			}
		});
	}

    $(document).ready(function () {
        $('[data-toggle="tooltip"]').tooltip();
    });
</script>