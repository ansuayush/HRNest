@model EXRecruit.Vacancy.Final
@{
	string MenuID = ViewBag.MenuID.ToString();
}
<div class="inner-main mb-5 pb-0">
	<h1 class="heading-one ">Final Announcement</h1>

	@{ Html.RenderAction("_EViewRequests", "Recruit", new { src = clsApplicationSetting.EncryptQueryString(MenuID + " */Recruit/_EViewRequests*" + ViewBag.REC_ReqID + "*Y") }); }



	<h2 class="header-two"><i class="fas fa-bullhorn"></i>Final Vacancy Announcement</h2>

	@*<div class="text-right mt-2">

			<a href="javascripts:;" target="_blank" id="btnApplication" class="btn mtr-g-grn "><i class="fas fa-link"></i>Application Form</a>
		</div>*@

	@using (Ajax.BeginForm("EVacancyFinal", "Recruit",
new { src = ViewBag.src },
new AjaxOptions { HttpMethod = "POST", OnSuccess = "EVacancyFinalSuccess", OnBegin = "ShowLoadingDialog();", OnFailure = "CloseLoadingDialog();" },
new
{
	@id = "EVacancyFinalFrom",
	enctype = "multipart/form-data"
})
)
	{
		@Html.HiddenFor(x => Model.REC_EVacancyID)
		@Html.HiddenFor(x => Model.REC_ReqID)

		<div class="row">

			<div class="col-lg-12 form-group">
				<ul class="list-unstyled inlin-list">
					<li>
						<input type="checkbox" id="wa" name="@Html.NameFor(x=>x.Web_Announce)" @(Model.Web_Announce == "True" ? "checked" : "")>
						<label for="wa"> Website Announcement  </label>
					</li>
					<li>
						<input type="checkbox" id="ia" name="@Html.NameFor(x=>x.Internal_Announce)" @(Model.Internal_Announce == "True" ? "checked" : "")>
						<label for="ia"> Internal Announcement  </label>
					</li>
					<li>
						<input type="checkbox" id="oa" name="@Html.NameFor(x=>x.Other_Announce)" @(Model.Other_Announce == "True" ? "checked" : "")>
						<label for="oa"> Other Apps  </label>
					</li>
					
				</ul>
			</div>

			<div class="col-lg-3 col-md-2 col-sm-6  form-group">
				<label>Start Date</label>
				@Html.TextBoxFor(x => Model.StartDate, new { @class = "form-control", @type = "date" })
				@Html.ValidationMessageFor(up => Model.StartDate, "", new { @class = "text-danger" })

			</div>
			<div class="col-lg-3 col-md-2 col-sm-6  form-group">
				<label>End Date</label>
				@Html.TextBoxFor(x => Model.EndDate, new { @class = "form-control", @type = "date" })
				@Html.ValidationMessageFor(up => Model.EndDate, "", new { @class = "text-danger" })
			</div>

			<div class="col-lg-3 col-md-4 col-sm-6  form-group">
				<label>Announcement Attachment</label>
				<p>@Html.ShowAttachment(Model.CommHRAttachID.ToString(), "green-clr")</p>
			</div>
			<div class="col-lg-12  form-group">
				<label>Vacancy Description for Website Announcement</label>
				<p>@Model.CommVacancyDes</p>
			</div>
			<div class="col-lg-12  form-group">
				<div id="signup" class="col-sm-5  mt-3 mb-3 hide">
					<div id="inviteCode" class="invite-page">
						<label class="lbl-abs">Application Link</label>
						<input id="link" value="@(clsApplicationSetting.GetConfigValue("WebsiteURL")+"Career/Home/Application?Code="+Model.REC_Code)" readonly="">
						<div id="copy" data-toggle="tooltip" data-original-title="Copy Link ">
							<i class="fa fa-clipboard" aria-hidden="true" data-copytarget="#link"></i>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row">

			<div class="col-lg-12 text-center mt-2">
				@if (Model.btnVisible)
				{
					<button type="submit" id="btnSave" class="btn mtr-o-grn btn-l ripplelink pull-right cancel" name="Command" value="Save"><i class="fas fa-save"></i>Save</button>
					<button type="submit" class="btn mtr-o-grn btn-l ripplelink pull-right" name="Command" value="Submit"><i class="fas fa-bullhorn"></i> Announce Vacancy</button>
				}
				<button type="button" id="btnGenerateLink" onclick="GenerateLink();" class="btn mtr-o-grn btn-l ripplelink pull-right cancel" name="Command" value="Save"><i class="fas fa-save"></i>Generate Link</button>
				@Html.CreateAnchor(MenuID, "/Recruit/EVacancyAnnouncement", "Back", "btn cnl-btn btn-l ripplelink", "Click to go back", "fas fa-arrow-left", "")

			</div>
		</div>
	}

</div>

@section scripts    {

	@System.Web.Optimization.Scripts.Render("~/bundle/unobtrusivejs")
	@Html.IncludeVersionedJs(Url.Content("~/assets/design/Scripts/AddInit.js"))

	<script>


		//$('#btnApplication').on('click', function (e) {
		//	var a = $("#hdnlink").val();
		//	if (a) {
		//		$(this).attr("href", a);
		//	}
		//});

		function GenerateLink() {
			$('#signup').attr('class', 'col-sm-5  mt-3 mb-3');
		}


		$('#btnSave').click(function () {
			$(this).closest('form').data("validator").cancelSubmit = true;
			return true;
		});


		function EVacancyFinalSuccess(obj) {

			if (obj.Status) {
				SuccessToaster(obj.SuccessMessage);
				window.location.href = obj.RedirectURL;
			}
			else {
				CloseLoadingDialog();
				FailToaster(obj.SuccessMessage);
			}
		}


		function ProjectTaggingSuccess(obj) {

			if (obj.Status) {
				SuccessToaster(obj.SuccessMessage);
				window.location.reload();
			}
			else {
				CloseLoadingDialog();
				FailToaster(obj.SuccessMessage);
			}
		}
	</script>

	<script type="text/javascript">

		$('#copy').on('click', function (event) {
			console.log(event);
			copyToClipboard(event);
		});

		function copyToClipboard(e) {
			var
				t = e.target,
				c = t.dataset.copytarget,
				inp = (c ? document.querySelector(c) : null);
			console.log(inp);
			if (inp && inp.select) {
				// select text
				inp.select();
				try {
					document.execCommand('copy');
					inp.blur();

					t.classList.add('copied');
					setTimeout(function () {
						t.classList.remove('copied');
					}, 1500);
				} catch (err) {
					alert('please press Ctrl/Cmd+C to copy');
				}

			}

		}
	</script>

}
