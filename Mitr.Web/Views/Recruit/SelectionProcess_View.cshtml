@using System.Data
@model IList<Mitr.Models.InterviewSelection.Round>
@{
	string MenuID = ViewBag.MenuID.ToString();
}
<div class="inner-main mb-5 pb-0">
	<h1 class="heading-one ">Selection Process</h1>

	@{ Html.RenderAction("_EViewRequests", "Recruit", new { src = clsApplicationSetting.EncryptQueryString(MenuID + " */Recruit/_EViewRequests*" + ViewBag.REC_ReqID + "*N") }); }


	<h2 class="header-two">
		<i class="fas fa-info-circle"></i>
		Choose slot
	</h2>
	<div class="mb-5 pb-0">
		<div class="tab-main tab-main-scd mb-3">
			<ul id="tabs" class="nav nav-tabs " role="tablist">
				@{ int countA = 0;}
				@foreach (var item in Model)
				{
					countA++;
					<li class="nav-item">
						<a id="tab-B" href="#A_@countA" class="nav-link @(countA==1?"active":"") ripplelink" data-toggle="tab" role="tab">
							<strong>@item.RoundName</strong>
						</a>
					</li>
				}
			</ul>
			<div id="content" class="tab-content shadow-box p-0" role="tablist">
				@{ int countB = 0;}
				@foreach (var item in Model)
				{
					countB++;
					<div id="A_@countB" class="card tab-pane fade @(countB==1?"show active":"")" role="tabpanel" aria-labelledby="tab-B">
						<div class="card-header" role="tab" id="heading-B">
							<h5 class="mb-0">
								<a class="collapsed" data-toggle="collapse" href="#collapse-1" aria-expanded="false" aria-controls="collapse-B">@item.RoundName</a>
							</h5>
						</div>
						<div id="collapse-1" class="collapse" data-parent="#content" role="tabpanel" aria-labelledby="heading-B">
							<div class="card-body">
								<div class="row">
									@if (!string.IsNullOrEmpty(item.RoundDesc))
									{
										<div class="col-sm-12 mt-2">
											<strong>Description</strong>
											<p>@item.RoundDesc</p>
										</div>
									}
									<div class="col-sm-12">
										<div class="table-responsive">
											<table class="table">
												<thead>
													<tr>
														<th class="w-33">Sno.</th>
														<th>Candidate Name</th>
														<th>Gender</th>
														<th>Date of Application</th>
														<th>Nationality</th>
														<th>Current Salary</th>
														<th>Expected Salary</th>
														<th>Total Experience</th>
														<th class="w-180">CV</th>

													</tr>
												</thead>
												<tbody>
													@if (item.ApplicationList != null)
													{
														int Count = 0;


														foreach (var item12 in item.ApplicationList)
														{
															Count++;
													<tr>
														<td>
															<input type="hidden" name="SETID" value="@item12.REC_InterviewSetID" />
															<input type="hidden" name="AppIID" value="@item12.REC_AppID" />
															<input type="hidden" name="I" value="@item12.REC_ReqID" />
															@Count
														</td>
														<td>
															@item12.Name
														</td>
														<td>
															@item12.Gender
														</td>
														<td>
															@item12.ApplyDate
														</td>
														<td>
															@item12.Nationality
														</td>
														<td>
															@item12.CurrentSalary
														</td>
														<td>
															@item12.ExpectedSalary
														</td>
														<td>
															@item12.TotalExperience
														</td>
														<td>
															<a data-toggle="tooltip" data-original-title="View" onclick="ViewApplication(this)" class="blk-clr mr-2"><i class="fas fa-eye"></i>View</a>
															<a href="@item12.CVPath" target="_blank" class="green-clr mr-2"><i class="fas fa-download"></i>Download CV</a>
														</td>


													</tr>
														}
													}
												</tbody>
											</table>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				}


			</div>

		</div>
		<div class="col-lg-12 text-center mt-2">
			<button type="button" class="btn cnl-btn ripplelink  pull-right"><i class="fas fa-times"></i> Cancel</button>
		</div>
	</div>
</div>
<div class="modal fade pop-dgn" id="ActionModal">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header blk-gdn-btn">
				<h4 class="modal-title"><i class="fas fa-plus"></i><span id="spnHead"></span> </h4>
				<div class="close" data-dismiss="modal">&times;</div>
			</div>
			<div class="modal-body">
				<div id="TargetActionDiv"></div>
			</div>
		</div>
	</div>
</div>


<div class="modal fade pop-dgn" id="ViewAppModal">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">

			<div class="modal-header blk-gdn-btn">
				<h4 class="modal-title">Application Form</h4>
				<div class="close" data-dismiss="modal">&times;</div>
			</div>
			<div class="modal-body">
				<div id="DivViewApp"></div>
			</div>
		</div>
	</div>
</div>


@section scripts    {

	@System.Web.Optimization.Scripts.Render("~/bundle/unobtrusivejs")
	@Html.IncludeVersionedJs(Url.Content("~/assets/design/Scripts/AddInit.js"))
	<script src="~/assets/design/Scripts/AddInit.js?v=@clsApplicationSetting.GetWebConfigValue("Version")"></script>
	<script>

			function ViewApplication(obj)
		{
			var AppIID = $(obj).closest("tr").find("input:hidden[name=AppIID]").val();
			$.ajax({
				url: "/Recruit/_ViewApplications",
				type: "Get",
				data: { src: EncryptQueryStringJSON(@ViewBag.MenuID+"*" + "/Recruit/_ViewApplications" + "*" + AppIID) },
				success: function (args) {
					CloseLoadingDialog();
					$("#DivViewApp").empty();
					$("#DivViewApp").html(args);
					$("#ViewAppModal").modal('show');
				},
				error: function (er) {
					CloseLoadingDialog()
				}
			});
		}


	
	</script>
}
