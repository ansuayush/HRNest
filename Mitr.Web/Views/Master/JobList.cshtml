
@model IList<Mitr.Models.Job>


@section style{
	@System.Web.Optimization.Styles.Render("~/bundle/dataTablecss")
}

<div class="inner-main mb-5 pb-0">
	@Html.Partial("ListHeader_Partial", "Job List")

	<div class="row">
		<div class="col-md-12 col-sm-12 col-xs-12">

			<div class="x_content table-currency m-0">

				<div class="table-responsive">
					<table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap tbltick new_width" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
						<thead>
							<tr>
								<th>S.no.</th>
								<th>Action</th>
								<th>Priority</th>
								<th>Job Code</th>
								<th>Title</th>
								<th>Desc</th>
								<th>Notice Period</th>
								<th>ProbationPeriod</th>
								<th>Inserted Date</th>
								<th>Updated Date</th>
								<th>IP Address</th>
							</tr>
							<tr class="searchbar">
								<th class="searchhide"></th>
								<th class="searchhide"></th>
								<th class="searchhide"></th>
								<th> </th>
								<th> </th>
								<th></th>
								<th> </th>
								<th></th>
								<th> </th>
								<th> </th>
								<th> </th>
							</tr>
						</thead>
						<tbody>
							@{ int Count = 0;}
							@foreach (Mitr.Models.Job item in Model)
							{
								Count++;
								<tr class="@(item.IsActive == true?"": "trrowred")">
									<td>@Count</td>
									<td>
										<input type="hidden" name="I" value="@item.JobID" />
										<input type="hidden" name="N" value="@item.Title" />

										<input type="hidden" id="hdn_@item.JobID" value="@item.JobCode" />
										@if (clsApplicationSetting.GetSessionValue("Modify") == "True")
										{										
											@Html.Raw(item.IsActive == true
											   ? "<a  data-toggle='tooltip' data-original-title='Click to DeActivate' list='JobList' OP='0' class='AIsActive' > <i class='fa fa-check-circle checkgreen' aria-hidden='true'></i></a>"
											   : "<a data-toggle='tooltip' data-original-title='Click to Activate' list='JobList' OP='1'  class='AIsActive' > <i class='fa fa-times-circle crossred' aria-hidden='true'></i></a>")

											<a title="Edit" onclick="ListHeaderAdd(@item.JobID);" data-toggle='tooltip'><i class="fas fa-edit checkgreen" aria-hidden="true"></i> </a>
											<a title="Add Round" href="@Url.Action("JobRound",new { src = clsApplicationSetting.EncryptQueryString(ViewBag.MenuID.ToString() + "*/Master/JobRound*"+item.JobID) })" data-toggle='tooltip'><i class="fas fa-share checkgreen" aria-hidden="true"></i>Add Round </a>
										}
									</td>
									<td>
										@Html.Raw(clsApplicationSetting.GetSessionValue("Modify") == "True" ? "<input type='number' id=\"txtPriority_" + @item.JobID + "\" onfocus=\"if(this.value == '0') { this.value=''}\" onblur=\"if(this.value==''){this.value='0'} else{UpdatePriority(this," + @item.JobID + ",'JobList');}\" value=\"" + @item.Priority + "\" />" : @item.Priority.ToString())
									</td>
									<td> @item.JobCode</td>
									<td>@item.Title</td>
									<td>@Html.Raw(item.Description)</td>
									<td>@item.NoticePeriod</td>
									<td>@item.ProbationPeriod</td>
									<td>@item.createdat</td>
									<td>@item.modifiedat</td>
									<td>@item.IPAddress</td>
								</tr>
							}
						</tbody>
					</table>
				</div>

			</div>
		</div>

	</div>
</div>
<div class="modal fade pop-dgn" id="ViewModal">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">

			<div class="modal-header blk-gdn-btn">
				<h4 class="modal-title"><i class="fas fa-print"></i>Add Job </h4>
				<div class="close" data-dismiss="modal">&times;</div>
			</div>
			<!-- Modal body -->
			<div class="modal-body">
				<div id="TagetDiv"></div>
			</div>
		</div>
	</div>
</div>

@section scripts    {
	@System.Web.Optimization.Scripts.Render("~/bundle/dataTablesjs")
	@System.Web.Optimization.Scripts.Render("~/bundle/unobtrusivejs")
	@Html.IncludeVersionedJs(Url.Content("~/assets/design/Scripts/AddInit.js"))
	@Html.IncludeVersionedJs(Url.Content("~/assets/design/Scripts/ToolTip.js"))
	@Html.IncludeVersionedJs(Url.Content("~/assets/design/Scripts/ckeditor.js"))
	<script>

		function ListHeaderAdd(CMSID) {
			ShowLoadingDialog();
        if (CMSID == undefined)
        {
            CMSID = 0;
        }
			$.ajax({
                url: "/Master/_JobAdd",
				type: "Get",
				data: { src: EncryptQueryStringJSON(@ViewBag.MenuID+"*" + "/Master/_JobAdd" + "*" + CMSID) },
                success: function (data)
                {
					$("#TagetDiv").empty();
                    $("#TagetDiv").html(data);
					$("#ViewModal").modal("show");
					$(".applyselect").select2();
					CloseLoadingDialog();
					ClassicEditor.create(document.querySelector('#QualificationDet'), {
							// toolbar: [ 'heading', '|', 'bold', 'italic', 'link' ]
						})
						.then(editor => {
							window.editor = editor;
						})
						.catch(err => {
							console.error(err.stack);
						});


					ClassicEditor.create(document.querySelector('#Description'), {
						// toolbar: [ 'heading', '|', 'bold', 'italic', 'link' ]
					})
						.then(editor => {
							window.editor = editor;
						})
						.catch(err => {
							console.error(err.stack);
						});

					var form = $("#_JobAddFrom")
                .removeData("validator")
                .removeData("unobtrusiveValidation");
                    $.validator.unobtrusive.parse(form);

				},
				error: function (er) {
					CloseLoadingDialog();

				}
			});
            }

    function OnSuccess(obj)
    {
        if (obj.Status) {
            window.location.reload();
        }
        else {
            FailToaster(obj.SuccessMessage);
			CloseLoadingDialog();
        }

    }
	</script>
}