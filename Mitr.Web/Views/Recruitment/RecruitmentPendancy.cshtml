@using System.Data
@model Mitr.Models.AllListModal

@section style{
    @System.Web.Optimization.Styles.Render("~/bundle/dataTablecss")
}

    <div class="inner-main">
        <div class="right_col" role="main">
            @Html.Partial("HeaderMsg_Partial")
            <h1 class="heading-one">
                Recruitment Pendancy List
            </h1>

            @using (Ajax.BeginForm("_RecruitmentPendancy", "Recruitment",
               new { src = clsApplicationSetting.EncryptQueryString(ViewBag.MenuID.ToString() + "*/Recruitment/_RecruitmentPendancy") },
               new AjaxOptions { HttpMethod = "POST", OnSuccess = "BindTarget" },
           new { @id = "__RecruitmentPendancy_HODFrom" })
           )
            {

                <div class="tab-main ">
                    <div class="row text-clr">
                        <div class="col-md-12">

                            <ul id="tabs" class="nav nav-tabs " role="tablist">
                                <li class="nav-item"> <a tabvalue="0" class="nav-link active ripplelink AnchorApproval" data-toggle="tab" role="tab"><i class="fal fa-envelope-open"></i>Pending</a> </li>
                                <li class="nav-item"> <a tabvalue="1" class="nav-link ripplelink AnchorApproval" data-toggle="tab" role="tab"><i class="fal fa-envelope-open"></i>Completed</a> </li>
                            </ul>
                        </div>

                        <div style="display:none">
                            @Html.HiddenFor(model => model.Approve)
                            <button type="submit" class="btn mtr-g-grn btn-l ripplelink" id="btnSearch" name="Command" value="Search">
                                <i class="fas fa-search"></i>Search
                            </button>
                        </div>

                    </div>
                </div>

            }

            <div id="TargetDiv"></div>

        </div>

        <div class="modal fade pop-dgn" id="ViewModal">
            <div class="modal-dialog modal-md">
                <div class="modal-content">

                    <div class="modal-header blk-gdn-btn">
                        <h4 class="modal-title"><i class="fas fa-print"></i>Budget Details	</h4>
                        <div class="close" data-dismiss="modal">&times;</div>
                    </div>
                    <!-- Modal body -->
                    <div class="modal-body">
                        <div id="ModalTagetDiv"></div>
                    </div>
                </div>
            </div>
        </div>

    </div>

@section scripts    {
    @System.Web.Optimization.Scripts.Render("~/bundle/dataTablesjs")
    <script src="~/assets/design/Scripts/AddInit.js?v=@clsApplicationSetting.GetWebConfigValue("Version")"></script>
    @System.Web.Optimization.Scripts.Render("~/bundle/unobtrusivejs");


    <script>
        $(document).ready(function () {
            $("#btnSearch").click();
        });
        $('.AnchorApproval').on('click', function (e) {
            e.preventDefault();
            e.stopPropagation();
            var att = $(this).attr("tabvalue");
            $(".AnchorApproval.active").removeClass("active");
            $(this).addClass("active");
            $("#Approve").val(att);
            ShowLoadingDialog();
            $("#btnSearch").click();
        });


        function BindTarget(args) {
            CloseLoadingDialog();
            $("#TargetDiv").empty();
            $("#TargetDiv").html(args);
            DatatableScriptsWithColumnSearch("tableRecrutment");

             $('.anchorpopup').on('click', function (e) {
            e.preventDefault();
            e.stopPropagation();
            var PDI = $(this).closest("td").find("input:hidden[name=PDI]").val();
            GetBudgetPartial(PDI);

             });
        }



           function GetBudgetPartial(ID) {
            $.ajax({
                url: "/Recruitment/_RecruitmentPendancy_ViewBudget",
                type: "Post",
                data: {
                    src: EncryptQueryStringJSON(MenuID + "*" + "/Recruitment/_RecruitmentPendancy_ViewBudget*" + ID )
                },
                success: function (data) {
                    $("#ModalTagetDiv").empty();
                    $("#ModalTagetDiv").html(data);
                    $("#ViewModal").modal('show');
                },
                error: function (er) {
                    alert(er);

                }
            });
        }

    </script>
}