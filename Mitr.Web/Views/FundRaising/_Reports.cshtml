@using System.Data
@model DataSet
<div class="table-responsive">
    @{
        <table id="table_Export" class="table table-striped table-bordered dt-responsive nowrap tbltick new_width" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
            <thead>
                <tr>
                    @foreach (DataColumn item in Model.Tables[0].Columns)
                    {
                        <th>@item</th>

                    }
                </tr>
                <tr class="searchbar">
                    @foreach (DataColumn item in Model.Tables[0].Columns)
                    {
                        <th> </th>
                    }
                </tr>
            </thead>
            <tbody>
                @{ int count = 0;}
                @if (Model.Tables[0].Rows.Count > 0)
                {
                    foreach (DataRow dtRow in Model.Tables[0].Rows)
                    {
                        count++;
                        <tr>
                            @foreach (DataColumn dc in Model.Tables[0].Columns)
                            {
                                <td>@dtRow[dc].ToString()</td>
                            }
                        </tr>
                    }
                }

            </tbody>
        </table>

    }
</div>
<script src="~/assets/tableToExcel.js"></script>
<script>
    $("#ExportExcel").click(function (e) {
        exportReportToExcel()
    });
    function exportReportToExcel() {
        let table = document.getElementsByTagName("table"); // you can use document.getElementById('tableId') as well by providing id to the table tag
        TableToExcel.convert(table[0], { // html code may contain multiple tables so here we are refering to 1st table tag
            name: `@(ViewBag.Doctype).xlsx`, // fileName you could use any name
            sheet: {
                name: 'Sheet 1' // sheetName
            }
        });
    }
</script>
